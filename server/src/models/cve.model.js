import mongoose from "mongoose";
import uniqueValidator from "mongoose-unique-validator";

const cveSchema = new mongoose.Schema(
    {
        /* 'cve.id': {
          type:String,
          //required: true,
        },*/

        cveId: {
            type: String,
            required: true,
            unique: true,
        },
        severity: {
            type: String,
            //required: true,
        },
        description: {
            type: String,
        },
        publishedDate: {
            type: Date,
            //required: true,
        },
        lastModifiedDate: {
            type: Date,
            //required: true,
        },
        references: [String],
        impact: {
            baseMetricV2: {
                severity: String,
                impactScore: Number,
                exploitabilityScore: Number,
            },
        },
    },
    { timestamps: true }
);

cveSchema.plugin(uniqueValidator);

const Cve = mongoose.model("Cve", cveSchema);



export default Cve;
