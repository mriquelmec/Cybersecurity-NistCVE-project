import React, { useState, useEffect } from 'react';
import axios from 'axios';
import { useParams, useNavigate } from 'react-router-dom';

const CVEdetails = () => {
    const { id } = useParams();
    const [cve, setCve] = useState({});
    const navigate = useNavigate();

    useEffect(() => {
        axios.get(`http://localhost:8000/api/cves/${id}`)
            .then((res) => {
                setCve(res.data);
            }).catch((err) => {
                console.log(err);
            });
    }, [id]);

    const deleteHandler = () => {
        axios.delete(`http://localhost:8000/api/cves/delete/${id}`)
            .then((res) => {
                navigate('/cve/getall');
            }).catch((err) => {
                console.log(err);
                console.log("ESTO ES ERROR DE FRONTEND");
            });
    };


    return (
        <div>
            <div className='bg-white d-flex flex-row justify-content-between col-6 mx-auto'>
                <h1>Details About: {cve ? cve.cveId : 'Loading...'}</h1>
            </div>
            <div className='card'>
                <p className='p-2'><strong>Cve Id:</strong> {cve.cveId}</p>
                <p className='p-2'><strong>Severity:</strong> {cve.severity}</p>
                <p className='p-2'><strong>Description</strong> {cve.description}</p>
                <p className='p-2'><strong>Published Date</strong> {cve.publishedDate}</p>
                <p className='p-2'><strong>Last Modified Date</strong> {cve.lastModifiedDate}</p> 
                <p className='p-2'><strong>URL: </strong> <a href={`https://nvd.nist.gov/vuln/detail/${cve.cveId}`} > https://nvd.nist.gov/vuln/detail/{cve.cveId} </a></p>
            </div>
            <a className='btn btn-success m-2' href='/cve/getall'><strong>Back to Dashboard</strong></a>
            <button className='btn btn-danger' onClick={deleteHandler}><strong>Delete this CVE:</strong> {cve.cveId}</button>
        </div>
    );
};

export default CVEdetails;







 